<!DOCTYPE html>
<html>
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
		<script src="/data.js"></script>
	</head>

	<body>
		<div class="question-container">
			
		</div>

		<p id="message">Sorry, wrong answer</p>

		<h3></h3>

		<div class="answer-container">
			
		</div>
		<script>

		var questionList = [{"answer":"12 Years A Slave","question":"In the antebellum United States, Solomon Northup, a free black man from upstate New York, is abducted and sold into slavery."},
		{"answer":"The Sound of Music","question":"A woman leaves an Austrian convent to become a governess to the children of a Naval officer widower."},
		{"answer":"The Sting","question":"In Chicago in September 1936, a young con man seeking revenge for his murdered partner teams up with a master of the big con to win a fortune from a criminal banker."},
		{"answer":"Gladiator","question":"When a Roman general is betrayed and his family murdered by an emperor's corrupt son, he comes to Rome as a gladiator to seek revenge."}];
		
		var total = 0;
		var finishedQuiz = false;		

		$(document).ready(function() {
			var currentQuestion = 0;
			var timer = 5;
			var timeout = null;
			
			//Display first question
			displayQuestion(currentQuestion, timer);
			//countdown(20, 1000);
			$('#message').hide();		

			$('input').on('keydown', function(e) {
				var userAnswer;		

				//when user presses enter
				if(e.which == 13) {
					//capture user input
					userAnswer = this.value.toLowerCase();
					//console.log(userAnswer);

					//check if answer matches
					if (userAnswer === questionList[currentQuestion].answer.toLowerCase()) {
						currentQuestion += 1;
						total += 1;			//increase score
						timer += 10;		//add time

						//if more questions remain, display the next question
						if (currentQuestion < questionList.length) {
							displayQuestion(currentQuestion, timer);
							//countdown(timer, 1000);
						} else {
							alert('Quiz over');
						}

					} else { // show user they are wrong.
						//console.log('Sorry wrong answer');

						$('input').val('');						
						$('#message').show();
						
						setTimeout( function() {
							$('#message').hide();
						}, 1200);
						
					}
					
				}
			});

		function displayQuestion(currentQuestion, timer) {
			//console.log(timer);
			if(currentQuestion === 0) {
				$('.question-container').html('<p>' + questionList[currentQuestion].question + '</p>');
				$('.answer-container').append('<input type="text" name="answer" placeholder="Type and press enter">');
				//$('h3').text(timer);

				var countdown = setInterval(function() {
					timer--;
					if(timer >= 0) { $('h3').text(timer); }

					if (timer == 0) {
						$('body').append('<h1>game over</h1>');
					}
				}, 1000);

			} else {
				$('input').val('');
				$('.question-container p').text(questionList[currentQuestion].question);

				//countdown()
				
				//clearInterval(countdown);
				
				setInterval(function() {
					timer--;
					if(timer >= 0) { 
						//$('h3').empty();
						$('h3').text(timer); 
					}

					if (timer == 0) {
						$('body').append('<h1>game over</h1>');
					}
				}, 1000);
			}
				
		}

		// function countdown(start, step) {
		// 	var startTime = start;
		// 	$('h3').text(startTime);

		// 	clearTimeout(null);
		// 	timeout = setTimeout( function () {
		// 		countdown(startTime - 1, step);
		// 	});
			
		// }
		
	});	

		</script>
	</body>
</html>
